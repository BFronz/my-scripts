#!/bin/sh
#


FILE="company-orgs-Jan-Jul-2015.txt";
 
rm -f /usr/wt/${FILE}
 
RDATE=" '1501','1502','1503','1504','1505','1506','1507','1508','1509','1510','1511','1512' ";
FLDS="org, domain, country, city, state, zip, isp, ip, naics, primary_sic, countrycode, dunsnum, 
domestichqdunsnumber, hqdunsnumber, gltdunsnumber, countrycode3, audience, 
audiencesegment, b2b, employeerange, forbes2k, fortune1k, industry, informationlevel, latitude, longitude, phone, revenuerange, subindustry, sum(cnt)";
     

echo "org	 domain	 country	 city	 state	 zip	 isp	 ip	 naics	 primary_sic	 countrycode	 dunsnum	 domestichqdunsnumber	 hqdunsnumber	 gltdunsnumber	 countrycode3	 audience	audiencesegment	 b2b	 employeerange	 forbes2k	 fortune1k	 industry	 informationlevel	 latitude	 longitude	 phone	 revenuerange	 subindustry	count" > ${FILE}
echo "SELECT ${FLDS} FROM thomtnetlogORGDAllM  WHERE date IN (${RDATE})  AND block='N' AND isp='N' AND org NOT IN ('&&&','--','--------------------------------------------------','#NAME?')  GROUP BY org,domain,city,state,zip"  | mysql -As thomas >> ${FILE}
          
echo "Done...";
exit;



FILE="company-org-2014-new-combined.txt";

rm -f /usr/tnet/${FILE}
 
RDATE=" '1401','1402','1403','1404','1405','1406','1407','1408','1409','1410','1411','1412' ";
FLDS="org, domain, country, city, state, zip, isp, ip, naics, primary_sic, countrycode, dunsnum, 
domestichqdunsnumber, hqdunsnumber, gltdunsnumber, countrycode3, audience, 
audiencesegment, b2b, employeerange, forbes2k, fortune1k, industry, informationlevel, latitude, longitude, phone, revenuerange, subindustry, sum(cnt) ";
   
  

echo "SELECT ${FLDS} FROM thomcompany_org_2014   GROUP  BY org, domain, city, state, zip "  | mysql -As thomas >> ${FILE}       
  
echo "Done...";
exit;


FILE="company-org-2014-newc.txt";

rm -f /usr/tnet/${FILE}
 
RDATE=" '1401','1402','1403','1404','1405','1406','1407','1408','1409','1410','1411','1412' ";
FLDS="org, domain, country, city, state, zip, isp, ip, naics, primary_sic, countrycode, dunsnum, 
domestichqdunsnumber, hqdunsnumber, gltdunsnumber, countrycode3, audience, 
audiencesegment, b2b, employeerange, forbes2k, fortune1k, industry, informationlevel, latitude, longitude, phone, revenuerange, subindustry, sum(cnt) ";
   

echo "org	 domain	 country	 city	 state	 zip	 isp	 ip	 naics	 primary_sic	 countrycode	 dunsnum	 domestichqdunsnumber	 hqdunsnumber	 gltdunsnumber	 countrycode3	 audience	audiencesegment	 b2b	 employeerange	 forbes2k	 fortune1k	 industry	 informationlevel	 latitude	 longitude	 phone	 revenuerange	 subindustry	count" > ${FILE}
echo "SELECT ${FLDS} FROM thomtnetlogORGCATDWIZ  WHERE date IN (${RDATE})  AND BLOCK='N'  GROUP  BY org, domain, city, state, zip "  | mysql -As thomas >> ${FILE}       
  
echo "Done..."; 
exit;



FILE="company-org-2014-new.txt";

rm -f /usr/tnet/${FILE}
 
RDATE=" '1401','1402','1403','1404','1405','1406','1407','1408','1409','1410','1411','1412' ";
FLDS="org, domain, country, city, state, zip, isp, ip, naics, primary_sic, countrycode, dunsnum, 
domestichqdunsnumber, hqdunsnumber, gltdunsnumber, countrycode3, audience, 
audiencesegment, b2b, employeerange, forbes2k, fortune1k, industry, informationlevel, latitude, longitude, phone, revenuerange, subindustry, sum(cnt) ";
   

echo "org	 domain	 country	 city	 state	 zip	 isp	 ip	 naics	 primary_sic	 countrycode	 dunsnum	 domestichqdunsnumber	 hqdunsnumber	 gltdunsnumber	 countrycode3	 audience	audiencesegment	 b2b	 employeerange	 forbes2k	 fortune1k	 industry	 informationlevel	 latitude	 longitude	 phone	 revenuerange	 subindustry	count" > ${FILE}
echo "SELECT ${FLDS} FROM thomtnetlogORGD14M  WHERE date IN (${RDATE})  AND BLOCK='N'  GROUP  BY org, domain, city, state, zip "  | mysql -As thomas >> ${FILE}       
  
echo "Done..."; 
exit;



FILE="company-org-2014.txt";

rm -f /usr/tnet/${FILE}
 
RDATE=" '1401','1402','1403','1404','1405','1406','1407','1408','1409','1410','1411','1412' ";
FLDS="org, domain, country, city, state, zip, isp, ip, naics, primary_sic, countrycode, dunsnum, 
domestichqdunsnumber, hqdunsnumber, gltdunsnumber, countrycode3, audience, 
audiencesegment, b2b, employeerange, forbes2k, fortune1k, industry, informationlevel, latitude, longitude, phone, revenuerange, subindustry, count";
   
 
echo "org	 domain	 country	 city	 state	 zip	 isp	 ip	 naics	 primary_sic	 countrycode	 dunsnum	 domestich qdunsnumber	 hqdunsnumber	 gltdunsnumber	 countrycode3	 audience	audiencesegment	 b2b	 employeerange	 forbes2k	 fortune1k	 industry	 informationlevel	 latitude	 longitude	 phone	 revenuerange	 subindustry" > ${FILE}
echo "SELECT ${FLDS}, count(*) FROM thomtnetlogORGD14M  WHERE date IN (${RDATE})  AND BLOCK='N' AND latitude!='0.0001' GROUP  BY org, domain, city, state, zip "  | mysql -As thomas >> ${FILE}

     
echo "Done...";
exit;


FILE="merge.sql";
 
echo "show create table categoryyearM"  | mysql -As thomas >> ${FILE}
echo "show create table catnav_ipn15M"  | mysql -As thomas >> ${FILE}
echo "show create table catnav_ipn_combo15"  | mysql -As thomas >> ${FILE}
echo "show create table catnav_lines_combo13"  | mysql -As thomas >> ${FILE}
echo "show create table flat_catnav_summmaryM"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGCATD15M"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGCATDWIZ"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGD15M"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGD"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGDAllM"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGDWIZ"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGPS15M"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGSITED15M"  | mysql -As thomas >> ${FILE}
echo "show create table tnetlogORGSITEDWIZ"  | mysql -As thomas >> ${FILE}
echo "show create table vtoolM"  | mysql -As thomas >> ${FILE}
 
echo "Done...";
exit;







FILE="a1alloysDec2014Mars.txt";

rm -f /usr/tnet/${FILE}

echo "
SELECT org, latitude,isp FROM thomtnetlogORGDWIZ WHERE date IN (1412) AND acct='20054320'  GROUP BY org ORDER BY org

"  | mysql -As thomas > ${FILE}




echo "Done...";
exit;


FILE="territory-04-Aug2014-Feb1015.txt";
  
rm -f /usr/tnet/${FILE}

echo "SELECT
user_appid as ID,
user_fname as First ,
user_lname as Last,
sm_usergroups,
sum(if(page='adunits'                 ,1,0)) as RenewalDashboard,
sum(if(page='All' || page='All'       ,1,0)) as VisitorActivity,
sum(if(page='alinkreport'             ,1,0)) as LinkstoYourWebsite,
sum(if(page='branchreport'            ,1,0)) as Branch,
sum(if(page='cadreport'               ,1,0)) as CAD,
sum(if(page='catnavcomboreport'       ,1,0)) as CatalogActivityontnetYourSite,
sum(if(page='catnavoffreport'         ,1,0)) as CatalogActivityOnYourSite,
sum(if(page='catnavonreport'          ,1,0)) as CatalogActivitytnet,
sum(if(page='catnavreport'            ,1,0)) as CatalogActivityOld,
sum(if(page='catregvreport'           ,1,0)) as RegisteredUsersVisitorTool,
sum(if(page='ccactivityreport'        ,1,0)) as ClientCenterClientLoginActivity,
sum(if(page='ccpreport'               ,1,0)) as CustomCompanyProfile,
sum(if(page='clientsalesreport'       ,1,0)) as ClientSalesInquiries,
sum(if(page='corankreport'            ,1,0)) as CompanyRank,
sum(if(page='domainreport'            ,1,0)) as  Visitor ,
sum(if(page='estarareport_new'        ,1,0)) as  CallsFromListings,
sum(if(page='formersreport'           ,1,0)) as  Formers,
sum(if(page='listingreport'           ,1,0)) as  Listing,
sum(if(page='newsactivebanner'        ,1,0)) as  ActivePreviewAdInclusionBanners,
sum(if(page='newsactivebannerkey'     ,1,0)) as  ActiveKeywordAdBanners,
sum(if(page='newscatsponsor'          ,1,0)) as  ActiveCategorySponsorBanners,
sum(if(page='newscobanner'            ,1,0)) as  ActiveCompanySpecificBanners,
sum(if(page='newsdetailreport'        ,1,0)) as  NewsReleaseDetail,
sum(if(page='newsimgreport'           ,1,0)) as BrandDisplayAdvertising,
sum(if(page='newsletterreport'        ,1,0)) as NewsLetter,
sum(if(page='newsprotool'             ,1,0)) as CompanyNewsActivity,
sum(if(page='newstile'                ,1,0)) as ActiveRightColumnButtons,
sum(if(page='newsvisitorreport'       ,1,0)) as NewsVisitor,
sum(if(page='noncatreport'            ,1,0)) as NonCategory,
sum(if(page='opportunityreport'       ,1,0)) as  Opportunity,
sum(if(page='prodheadreport'          ,1,0)) as  CategoryReport,
sum(if(page='psreport'                ,1,0)) as  ProductSearch,
sum(if(page='quickreport'             ,1,0)) as  QueryTool,
sum(if(page='reachlocalreport'        ,1,0)) as  MST,
sum(if(page='reachlocalwreport'       ,1,0)) as  MSTWeekly,
sum(if(page='Registration'            ,1,0)) as  Registration,
sum(if(page='Site'                    ,1,0)) as SiteReport,
sum(if(page='State'                   ,1,0)) as StateSummary, 
sum(if(page='testdrive_reports'       ,1,0)) as TestDrive,
sum(if(page='trendreport'             ,1,0)) as MonthlyTrend,
sum(if(page='visitortoolreport'       ,1,0)) as VisitorTool,
sum(if(page='webtraxsreport'          ,1,0)) as LeadOriginReport,
sum(if(page='wizardreport'             ,1,0)) as WizardReport
FROM tnetrpt_log
WHERE user_appid>0 AND (created >= 1406865600 && created <= 1424280881) AND user_appid!=9976 AND user_appid!=9999 AND cid in (
  710624,
  457936,
  564123,
  563022,
  608262,
  621102,
  696779,
  941438,
  943909,
  943914,
  943704,
  952709,
  954646,
  955703,
  955682,
  997894,
  997492,
 1006922,
 1056919,
 1008661,
 1061421,
 1061671,
 1014508,
 1042121,
 1054550,
 1057822,
 1063314,
 1065579,
 1087572,
 1089705,
 1139353,
 1139360,
 1139363,
 1145973,
 1274149,
 1188603,
 1232643,
 1268818,
 1204534,
 1058918,
   81072,
30414468,
10002442,
 1278455,
 1279520,
 1287123,
 1287806,
 1288651,
 1288723,
 1303665,
 1307989,
 1308479,
 1308134,
 1308143,
30113935,
   53040,
 1297654,
 1006276,
   83799,
10030720,
10016468,
10015816,
10020058,
10023012,
30362557,
10026062,
10029095,
30218599,
10030794,
10032703,
30373884,
10043346,
30716672,
10048243,
10048567,
10071063,
10060382,
10065106,
10059350,
10063833,
10064116,
10056703,
10077084,
10084958,
30601788,
10082101,
10106716,
10078256,
10079531,
  100862,
10078725,
10110590,
10078883,
10100512,
10085575,
20035500,
30648568,
20045900,
30102121,
20105335,
30673220,
   79690,
20094204,
20083721,
20095158,
30083367,
30096978,
30105581,
30089920,
30133379,
30080353,
30119373,
   61950,
   64264,
30117088,
30718317,
  641220,
10109701,
 1064695,
 1086287,
30382719,
30164991,
30165551,
30127719,
30168530,
30170723,
30159011,
30194199,
30186747,
30138142,
30138959,
30149240,
30173794,
30146289,
   71531,
   83603,
 1308694,
30730901,
30731377,
30726193,
30443169,
   50839,
 1288105,
30729248,
30729298,
   59669,
30733781,
   80146,
30729515,
30729651,
30725984,
30739746,
30730043,
30732269,
10074075,
   66459,
30419208,
10107372,
 1288344,
 1308801,
   51172,
30159199,
  955263,
30307269,
   96456,
30293185,
   80733,
  460945,
30343084,
10004182,
10012413,
 1222095,
30724795,
30654329,
30704685,
30710312,
30381704,
30639148,
  675427,
30580748,
30384872,
30715752,
30336604,
30586128,
30587988,
   54467,
30599549,
30675772,
30389279,
30667448,
30712656,
30730250,
   77258,
   79822,
   80420,
30726212,
30522988,
   97177,
30514848,
30102180,
 1307895,
10036325,
10111613,
   83475,
30085033,
30633228,
30715486,
30716082,
  100299,
30610269,
   71395,
20079052,
30734593,
30596468,
   97762,
   98669,
   63646,
   72713,
30725084,
30606708,
   98338,
   72276,
 1070344,
 1071834,
30763992,
30723200,
   97370,
 1308046,
30748132,
10068775,
30629108,
30629668,
30717453,
30765706,
30712755,
30727826,
 1202511,
30718164,
  607496,
  627424,
30396108,
   64582,
30514928,
30515908,
   95696,
   95744,
   53562,
30745777,
30745779,
30517028,
   95781,
30425488,
30728446,
   54169,
   65389,
   65576,
   67375,
   67423,
   67437,
   78387,
   78919,
   79333,
   80168,
   80229,
   59857,
   60866,
   61173,
   61303,
   61797,
   71564,
   71565,
   62613,
   63092,
   48683,
   51175,
   51614,
30733090,
   95869,
   96139,
   96183,
   96260,
   96344,
   96657,
   96671,
   80426,
   80907,
   81071,
   82272,
   84056,
   96841,
   97720,
   98670,
   98703,
   99046,
   71910,
   72205,
   85881,
   99579,
   99893,
  100181,
  100776,
  101120,
   51849,
   51948,
   52255,
   64025,
   64142,
   64171,
   73546,
   76188,
   77319,
   77322,
   77339,
   77607,
   77877,
   77887,
   77951,
   91680,
   93574,
   93627,
   94257,
  101311,
  101312 )
GROUP BY ID " | mysql -As thomas >> ${FILE}
 



  



FILE="territory-04-Aug2014-Feb1015-bulk.txt";

rm -f /usr/tnet/${FILE}


echo " SELECT user_appid, sum(supcnt), sum(listcnt) FROM tgrams.alc_reports
WHERE user_appid>0 AND (created >= 1406865600 && created <= 1424280881) AND user_appid!=9976 AND user_appid!=9999 AND acct in (
  710624,
  457936,
  564123,
  563022,
  608262,
  621102,
  696779,
  941438,
  943909,
  943914,
  943704,
  952709,
  954646,
  955703,
  955682,
  997894,
  997492,
 1006922,
 1056919,
 1008661,
 1061421,
 1061671,
 1014508,
 1042121,
 1054550,
 1057822,
 1063314,
 1065579,
 1087572,
 1089705,
 1139353,
 1139360,
 1139363,
 1145973,
 1274149,
 1188603,
 1232643,
 1268818,
 1204534,
 1058918,
   81072,
30414468,
10002442,
 1278455,
 1279520,
 1287123,
 1287806,
 1288651,
 1288723,
 1303665,
 1307989,
 1308479,
 1308134,
 1308143,
30113935,
   53040,
 1297654,
 1006276,
   83799,
10030720,
10016468,
10015816,
10020058,
10023012,
30362557,
10026062,
10029095,
30218599,
10030794,
10032703,
30373884,
10043346,
30716672,
10048243,
10048567,
10071063,
10060382,
10065106,
10059350,
10063833,
10064116,
10056703,
10077084,
10084958,
30601788,
10082101,
10106716,
10078256,
10079531,
  100862,
10078725,
10110590,
10078883,
10100512,
10085575,
20035500,
30648568,
20045900,
30102121,
20105335,
30673220,
   79690,
20094204,
20083721,
20095158,
30083367,
30096978,
30105581,
30089920,
30133379,
30080353,
30119373,
   61950,
   64264,
30117088,
30718317,
  641220,
10109701,
 1064695,
 1086287,
30382719,
30164991,
30165551,
30127719,
30168530,
30170723,
30159011,
30194199,
30186747,
30138142,
30138959,
30149240,
30173794,
30146289,
   71531,
   83603,
 1308694,
30730901,
30731377,
30726193,
30443169,
   50839,
 1288105,
30729248,
30729298,
   59669,
30733781,
   80146,
30729515,
30729651,
30725984,
30739746,
30730043,
30732269,
10074075,
   66459,
30419208,
10107372,
 1288344,
 1308801,
   51172,
30159199,
  955263,
30307269,
   96456,
30293185,
   80733,
  460945,
30343084,
10004182,
10012413,
 1222095,
30724795,
30654329,
30704685,
30710312,
30381704,
30639148,
  675427,
30580748,
30384872,
30715752,
30336604,
30586128,
30587988,
   54467,
30599549,
30675772,
30389279,
30667448,
30712656,
30730250,
   77258,
   79822,
   80420,
30726212,
30522988,
   97177,
30514848,
30102180,
 1307895,
10036325,
10111613,
   83475,
30085033,
30633228,
30715486,
30716082,
  100299,
30610269,
   71395,
20079052,
30734593,
30596468,
   97762,
   98669,
   63646,
   72713,
30725084,
30606708,
   98338,
   72276,
 1070344,
 1071834,
30763992,
30723200,
   97370,
 1308046,
30748132,
10068775,
30629108,
30629668,
30717453,
30765706,
30712755,
30727826,
 1202511,
30718164,
  607496,
  627424,
30396108,
   64582,
30514928,
30515908,
   95696,
   95744,
   53562,
30745777,
30745779,
30517028,
   95781,
30425488,
30728446,
   54169,
   65389,
   65576,
   67375,
   67423,
   67437,
   78387,
   78919,
   79333,
   80168,
   80229,
   59857,
   60866,
   61173,
   61303,
   61797,
   71564,
   71565,
   62613,
   63092,
   48683,
   51175,
   51614,
30733090,
   95869,
   96139,
   96183,
   96260,
   96344,
   96657,
   96671,
   80426,
   80907,
   81071,
   82272,
   84056,
   96841,
   97720,
   98670,
   98703,
   99046,
   71910,
   72205,
   85881,
   99579,
   99893,
  100181,
  100776,
  101120,
   51849,
   51948,
   52255,
   64025,
   64142,
   64171,
   73546,
   76188,
   77319,
   77322,
   77339,
   77607,
   77877,
   77887,
   77951,
   91680,
   93574,
   93627,
   94257,
  101311,
  101312 )
GROUP BY user_appid  " | mysql -As thomas >> ${FILE}

echo "Done...";
